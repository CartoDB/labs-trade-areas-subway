<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deep-Insights.js</title>
  <meta name=viewport content="width=device-width initial-scale=1">
  <link rel="stylesheet" href="lib/themes/css/deep-insights.css" />
  <link rel="stylesheet" href="lib/rangeslider.css" />
  <link rel="shortcut icon" href="favicon.ico" />
  <script src="lib/deep-insights.uncompressed.js"></script>
  <script src="lib/rangeslider.min.js"></script>
  <script src="//localhost:9096"></script>
  <style type="text/css">
    html, body {
      position:relative;
      height: 100%;
      padding: 0;
      margin: 0;
    }
    .subway_station {
      width: 10px !important;
      height: 10px !important;
      background: #fff;
      border-radius: 99px;
      border: 2.5px solid #000;
    }
    /* http://danielstern.ca/range.css/ */
    .Range-wrapper {
      display: inline-block;
      width: 100%;
    }
    .Range {
      -webkit-appearance: none;
      width: 100%;
      margin: 8px 0 16px;
      text-rendering: optimizeLegibility;
      -webkit-text-rendering: optimizeLegibility;
    }
    .Range:focus {
      outline: none;
    }
    .Range::-webkit-slider-runnable-track {
      width: 100%;
      height: 4px;
      cursor: pointer;
      background: #3aa9e3;
      border-radius: 3px;
      border: 0px solid #010101;
    }
    .Range::-webkit-slider-thumb {
      box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
      border: 1px solid #cbced0;
      height: 20px;
      width: 20px;
      border-radius: 11px;
      background: #ffffff;
      cursor: pointer;
      -webkit-appearance: none;
      margin-top: -8px;
    }
    .Range:focus::-webkit-slider-runnable-track {
      background: #3aa9e3;
    }
    .Range::-moz-range-track {
      width: 100%;
      height: 4px;
      cursor: pointer;
      background: #3aa9e3;
      border-radius: 0px;
      border: 0px solid #010101;
    }
    .Range::-moz-range-thumb {
      box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
      border: 1px solid #cbced0;
      height: 20px;
      width: 20px;
      border-radius: 11px;
      background: #ffffff;
      cursor: pointer;
    }
    .Range::-ms-track {
      width: 100%;
      height: 4px;
      cursor: pointer;
      background: transparent;
      border-color: transparent;
      color: transparent;
    }
    .Range::-ms-fill-lower {
      background: #3aa9e3;
      border: 0px solid #010101;
      border-radius: 0px;
    }
    .Range::-ms-fill-upper {
      background: #3aa9e3;
      border: 0px solid #010101;
      border-radius: 0px;
    }
    .Range::-ms-thumb {
      box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
      border: 1px solid #cbced0;
      height: 20px;
      width: 20px;
      border-radius: 11px;
      background: #ffffff;
      cursor: pointer;
      height: 4px;
    }
    .Range:focus::-ms-fill-lower {
      background: #3aa9e3;
    }
    .Range:focus::-ms-fill-upper {
      background: #3aa9e3;
    }
    .Range-period {
      margin-left: 18%;
      color: #979EA1;
      font-weight: 400;
      font-size: 10px;
      line-height: 14px;
      font-family: 'Open Sans';
    }
    @media (max-width: 960px) {
      .Range-period {
        margin-left: 7%;
      }
    }
    .Range-period:first-child {
      margin-left: 0;
    }
    .u-ilist > li {
      display: inline-block;
    }
  </style>
</head>
<body>
  <div id="dashboard"></div>
  <div class="CDB-Widget CDB-Widget--light js-iso-selector" style="display: block;">
    <div class="CDB-Widget-body">
      <div class="CDB-Widget-header js-header">
        <div class="CDB-Widget-title CDB-Widget-contentSpaced">
          <h3 class="CDB-Text CDB-Size-large u-ellipsis js-title">Max walking distance</h3>
        </div>
      </div>
      <div class="CDB-Widget-content">
        <div class="CDB-Widget-filter CDB-Widget-contentSpaced">
          <p class="CDB-Text CDB-Size-small is-semibold u-upperCase js-Range-val">20 min</p>
        </div>
        <div class="Range-wrapper">
          <input id="Range" class="Range js-Range" type="range" min="300" max="1200" step="300" value="1200" />
          <ul class="u-ilist">
            <li class="Range-period">5 min</li>
            <li class="Range-period">10 min</li>
            <li class="Range-period">15 min</li>
            <li class="Range-period">20 min</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <script type="text/template" id="sql_blockgroups">
    SELECT
    nerikcarto.nyc_census_clipped.cartodb_id,
    nerikcarto.nyc_census_clipped.the_geom,
    nerikcarto.nyc_census_clipped.total_pop,
    nerikcarto.nyc_census_clipped.median_age,
    nerikcarto.nyc_census_clipped.per_capita_income,
    nerikcarto.nyc_census_clipped.ethnic_1st,
    nerikcarto.nyc_census_clipped.the_geom_webmercator
    FROM
    nerikcarto.nyc_census_clipped
    WHERE
    ST_Intersects(
    nerikcarto.nyc_census_clipped.the_geom,
      (SELECT
      the_geom
      FROM
      nerikcarto.nyc_subway_stations_l_isos
      WHERE
      data_range = <%= data.range %>
      AND
      station_id = <%= data.station_id %>
      LIMIT 1
      )
    )


  </script>
  <script type="text/template" id="sql_dots">
    select
    nerikcarto.nyc_dots_500.cartodb_id,
    nerikcarto.nyc_dots_500.the_geom,
    nerikcarto.nyc_dots_500.the_geom_webmercator,
	ST_Within(
    	nerikcarto.nyc_dots_500.the_geom,
    	(
  SELECT
    the_geom
  FROM
  	nerikcarto.nyc_subway_stations_l_isos
  WHERE
  	data_range = <%= range %>
  AND
  	station_id = <%= station_id %>
  LIMIT 1
)
    ) inside

FROM nerikcarto.nyc_dots_500


  </script>
  <script type="text/template" id="css_per_capita_income">
    #nyc_census_clipped{
      polygon-fill: #FFFFB2;
      polygon-opacity: 0.8;
      line-color: #FFF;
      line-width: 0.5;
      line-opacity: 1;
    }
    #nyc_census_clipped [ per_capita_income <= 369260] {
       polygon-fill: #B10026;
    }
    #nyc_census_clipped [ per_capita_income <= 57496] {
       polygon-fill: #E31A1C;
    }
    #nyc_census_clipped [ per_capita_income <= 40065] {
       polygon-fill: #FC4E2A;
    }
    #nyc_census_clipped [ per_capita_income <= 31793] {
       polygon-fill: #FD8D3C;
    }
    #nyc_census_clipped [ per_capita_income <= 25329] {
       polygon-fill: #FEB24C;
    }
    #nyc_census_clipped [ per_capita_income <= 20182] {
       polygon-fill: #FED976;
    }
    #nyc_census_clipped [ per_capita_income <= 14978] {
       polygon-fill: #FFFFB2;
    }
  </script>
  <script type="text/template" id="css_median_age">
    #nyc_census_clipped{
  polygon-fill: #F1EEF6;
  polygon-opacity: 0.8;
  line-color: #FFF;
  line-width: 0.5;
  line-opacity: 1;
}
#nyc_census_clipped [ median_age <= 85.8] {
   polygon-fill: #91003F;
}
#nyc_census_clipped [ median_age <= 58.9] {
   polygon-fill: #CE1256;
}
#nyc_census_clipped [ median_age <= 51.3] {
   polygon-fill: #E7298A;
}
#nyc_census_clipped [ median_age <= 44] {
   polygon-fill: #DF65B0;
}
#nyc_census_clipped [ median_age <= 36.8] {
   polygon-fill: #C994C7;
}
#nyc_census_clipped [ median_age <= 29.5] {
   polygon-fill: #D4B9DA;
}
#nyc_census_clipped [ median_age <= 22.2] {
   polygon-fill: #F1EEF6;
}
</script>
  <script type="text/template" id="css_ethnic_1st">
    #nyc_census_clipped {
   polygon-opacity: 0.7;
   line-color: #FFF;
   line-width: 0.5;
   line-opacity: 1;
}

#nyc_census_clipped[ethnic_1st="asian"] {
   polygon-fill: #fe528d;
}
#nyc_census_clipped[ethnic_1st="black"] {
   polygon-fill: #18a79e;
}
#nyc_census_clipped[ethnic_1st="hispanic or latino"] {
   polygon-fill: #ff8a00;
}
#nyc_census_clipped[ethnic_1st="other"] {
   polygon-fill: #cccccc;
}
#nyc_census_clipped[ethnic_1st="white"] {
   polygon-fill: #a0a4d5;
}
  </script>
  <script src="vis.js"></script>
  <script src="index.js"></script>
</body>
</html>
